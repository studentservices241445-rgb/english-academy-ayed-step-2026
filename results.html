<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ูุชูุฌุชู ูุฎุทุชู | ุงูุฏูุฑุฉ ุงูููุซูุฉ STEP 2026</title>
  <meta name="description" content="ูุชูุฌุฉ ุชุญุฏูุฏ ุงููุณุชูู + ุฎุทุฉ ูุฐุงูุฑุฉ ุดุฎุตูุฉ ุญุณุจ ููุช ุงุฎุชุจุงุฑู ููุณุชูุงู." />

  <!-- Styles -->
  <link rel="stylesheet" href="./assets/styles.css?v=2026-01-20" />
</head>

<body class="theme-dark">
  <!-- Header -->
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="./index.html" aria-label="ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ">
        <span class="brand__mark">โ</span>
        <span class="brand__name">English Academy | STEP 2026</span>
      </a>

      <nav class="nav">
        <a href="./index.html" class="nav__link">ุงูุฑุฆูุณูุฉ</a>
        <a href="./course-content.html" class="nav__link">ูุญุชูู ุงูุฏูุฑุฉ</a>
        <a href="./faq.html" class="nav__link">ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ</a>
        <a href="./testimonials.html" class="nav__link">ูุตุต ุงููุฌุงุญ</a>
        <a href="./support.html" class="nav__link">ุงูุฏุนู</a>
        <a href="./level-test.html" class="nav__link nav__link--primary">ุชุญุฏูุฏ ุงููุณุชูู</a>
      </nav>
    </div>
  </header>

  <!-- Top notice (optional dynamic) -->
  <div class="topbar" role="status" aria-live="polite">
    <div class="container topbar__inner">
      <span>ูุชูุฌุชู ุฌุงูุฒุฉ โ ุงูุขู ุจุชุดูู ุงูุฎุทุฉโฆ ูุจุนุฏูุง ูุธูุฑ ูู ุฎูุงุฑ ุงูุชุณุฌูู.</span>
      <span class="topbar__hint">ููุงุญุธุฉ: ุงูุณุนุฑ ูุธูุฑ ุจุนุฏ ุงูุงุฎุชุจุงุฑ ููุท.</span>
    </div>
  </div>

  <main class="container section">
    <section class="card">
      <header class="section-head">
        <div>
          <h1 class="h2">ูุชูุฌุชู ูุฎุทุชู ุงูุดุฎุตูุฉ</h1>
          <p class="muted">ููุง ุจููุถุญ ูู ูุถุนู ุจุงูุถุจุท: ูุด ูููุ ูุด ูุญุชุงุฌ ุชุฑููุฒุ ูููู ุชูุดู ุฏุงุฎู ุงูุฏูุฑุฉ ุฎุทูุฉ ุจุฎุทูุฉ.</p>
        </div>

        <div class="badge" id="resultVersion">โ</div>
      </header>

      <!-- If no result -->
      <div id="noResult" class="note note--danger" style="display:none;">
        <h3 class="h3">ูุง ููููุง ูุชูุฌุฉ ูุญููุธุฉ</h3>
        <p>ูุงุถุญ ุฅูู ูุง ุฎูุตุช ุงุฎุชุจุงุฑ ุชุญุฏูุฏ ุงููุณุชูู. ูุง ุชุดูู ููโฆ ุฎุฐ ุงูุงุฎุชุจุงุฑุ ูุจุนุฏูุง ุชุฌูู ุงูุฎุทุฉ ููุง ูุจุงุดุฑุฉ.</p>
        <div class="actions">
          <a class="btn btn--primary" href="./level-test.html">ุงุจุฏุฃ ุชุญุฏูุฏ ุงููุณุชูู</a>
          <a class="btn btn--ghost" href="./index.html">ุฑุฌูุน ููุฑุฆูุณูุฉ</a>
        </div>
      </div>

      <!-- Result view -->
      <div id="resultWrap" style="display:none;">
        <!-- Summary -->
        <div class="grid-2">
          <div class="card inner">
            <h3 class="h3">ููุฎุต ุณุฑูุน</h3>
            <div class="stack small-gap">
              <div class="kpi">
                <div class="kpi__label">ุงุณูู</div>
                <div class="kpi__value" id="rName">โ</div>
              </div>

              <div class="kpi">
                <div class="kpi__label">ููุนุฏ ุงุฎุชุจุงุฑู</div>
                <div class="kpi__value" id="rExamDate">โ</div>
              </div>

              <div class="kpi">
                <div class="kpi__label">ููุช ูุฐุงูุฑุชู ุงููููู</div>
                <div class="kpi__value" id="rDaily">โ</div>
              </div>

              <div class="kpi">
                <div class="kpi__label">ูุฏูู</div>
                <div class="kpi__value" id="rTarget">โ</div>
              </div>
            </div>
          </div>

          <div class="card inner">
            <h3 class="h3">ูุชูุฌุชู ุงูุญุงููุฉ</h3>
            <div class="score">
              <div class="score__big" id="rPercent">0%</div>
              <div class="muted" id="rScoreLine">โ</div>
              <div class="progress">
                <span id="rBar" style="width:0%"></span>
              </div>
              <p class="muted small" id="rSummaryLine">โ</p>
            </div>
          </div>
        </div>

        <!-- Sections -->
        <div class="card inner">
          <h3 class="h3">ุชุญููู ุงูุฃูุณุงู</h3>
          <p class="muted small">ููุง ุชุดูู ุฃุฏุงุกู ุจูู ูุณูโุนุดุงู ุชุนุฑู ููู ุชุญุท ูุฌููุฏู ุฏุงุฎู ุงูุฏูุฑุฉ.</p>

          <div class="table-wrap">
            <table class="table" id="sectionsTable" aria-label="ุฌุฏูู ุชุญููู ุงูุฃูุณุงู">
              <thead>
                <tr>
                  <th>ุงููุณู</th>
                  <th>ุงูุฅุฌุงุจุงุช</th>
                  <th>ุงูุตุญูุญ</th>
                  <th>ุงููุณุจุฉ</th>
                  <th>ุงูุชูุฌูู</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <!-- Plan -->
        <div class="card inner">
          <h3 class="h3">ุงูุฎุทุฉ ุงูููุชุฑุญุฉ ูู</h3>
          <p class="muted" id="planSummary">โ</p>
          <div class="note">
            <p class="small" id="planReasoning">โ</p>
          </div>

          <ul class="bullets" id="planBullets"></ul>

          <div class="actions">
            <a class="btn btn--primary" href="./register.html" id="goRegisterBtn">ุงุนุชูุงุฏ ุงูุฎุทุฉ ูุงูุงูุชูุงู ููุชุณุฌูู</a>
            <a class="btn btn--ghost" href="./level-test.html">ุฅุนุงุฏุฉ ุชุญุฏูุฏ ุงููุณุชูู</a>
          </div>
        </div>

        <!-- Price (ุธูุฑ ุจุนุฏ ุงูุงุฎุชุจุงุฑ ููุท) -->
        <div class="card inner price-card" id="priceCard">
          <div class="price-head">
            <div>
              <h3 class="h3">ุงูุณุนุฑ ุจุนุฏ ูุง ุนุฑููุง ุฎุทุชู โ</h3>
              <p class="muted small">ุงูุฎุตู ูุฑุจูุท ุจุงูููุงุนุฏ ุงููุชุงุญุฉ (ุนุดุงู ูุถูู ุฌูุฏุฉ ุงููุชุงุจุนุฉ).</p>
            </div>
            <div class="seat-widget" aria-live="polite">
              <div class="seat-widget__label">ุงูููุงุนุฏ ุงููุชุจููุฉ</div>
              <div class="seat-widget__value" id="seatsLeft">โ</div>
              <div class="seat-widget__hint muted small" id="seatHint">ูู ูุง ูููุช ุงูููุงุนุฏโฆ ูุฑุฌุน ุงูุณุนุฑ ุงูุฑุณูู.</div>
            </div>
          </div>

          <div class="prices">
            <div class="price-box price-box--hot">
              <div class="price-box__tag">ุงูุณุนุฑ ุงูุญุงูู (ุฎุตู)</div>
              <div class="price-box__value">349 ุฑูุงู</div>
              <div class="price-box__note muted small">ููุชูู ุนูุฏ ุงูุชูุงู ุงูููุงุนุฏ ุงููุฎููุถุฉ.</div>
            </div>

            <div class="price-box">
              <div class="price-box__tag">ุงูุณุนุฑ ุงูุฑุณูู</div>
              <div class="price-box__value">599 ุฑูุงู</div>
              <div class="price-box__note muted small">ูุฑุฌุน ุจุนุฏ ุงูุชูุงู ุงูููุงุนุฏ/ุงูุชูุงุก ุงูุฎุตู.</div>
            </div>
          </div>

          <div class="actions">
            <a class="btn btn--primary" href="./register.html">ุณุฌูู ุงูุญูู (ุนูู ุงูุณุนุฑ ุงูุญุงูู)</a>
            <a class="btn btn--ghost" href="./course-content.html">ุฃุจู ุฃุดูู ูุญุชูู ุงูุฏูุฑุฉ ุฃูู</a>
          </div>
        </div>

        <!-- Wrong answers -->
        <div class="card inner">
          <h3 class="h3">ุฃุฎุทุงุกู ูุน ุงูุญู ุงููุฎุชุตุฑ</h3>
          <p class="muted small">ูุฏููุง ููุง ูู โูุฌูุฏูโ ๐โฆ ูุฏููุง ูููู ุงูุฎุทุฃ ููุตูุญู ุจุณุฑุนุฉ.</p>

          <div id="wrongList" class="accordion"></div>

          <div class="note note--soft">
            <p class="small">
              ุชูุจูู ุจุณูุท: ุฅุฐุง ุชุจุบู ุชุฑูุน ูุณุชูุงู ุจุณุฑุนุฉุ ูุง ุชูุชูู ุชุนุฑู ุงูุตุญโฆ ูุงุฒู ุชุนุฑู โููุด ุบูุทุชโ (ูุงุนุฏุฉุ ูููุฉุ ููู ุณุคุงูุ).
              ุฏุงุฎู ุงูุฏูุฑุฉ ุจูุญููุง ูุนู ุฎุทูุฉ ุจุฎุทูุฉ.
            </p>
          </div>
        </div>

        <!-- CTA -->
        <div class="card inner">
          <h3 class="h3">ุฌุงูุฒ ุชุจุฏุฃุ</h3>
          <p class="muted">ุฅุฐุง ุชุจุบู ุชูุดู ุตุญ ูู ุงูููู ุงูุฃููโฆ ุณุฌูู ูุฎูู ุนูู ุฎุทุชู ุจุฏูู ุชุดุชุช.</p>
          <div class="actions">
            <a class="btn btn--primary" href="./register.html">ุงุจุฏุฃ ุงูุชุณุฌูู ุงูุขู</a>
            <a class="btn btn--ghost" href="./support.html">ุนูุฏู ุงุณุชูุณุงุฑ ุณุฑูุน</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Assistant + Toasts placeholders (ูู app.js ูุณุชุฎุฏููุง) -->
  <div id="toasts" class="toast-wrap" aria-live="polite"></div>
  <div id="floatingAssistantMount"></div>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div class="muted small">ยฉ 2026 โ English Academy | ุงูุฏูุฑุฉ ุงูููุซูุฉ STEP</div>
      <div class="footer-links">
        <a href="./privacy.html">ุงูุฎุตูุตูุฉ</a>
        <a href="./terms.html">ุงูุดุฑูุท</a>
        <a href="./refund.html">ุงูุงุณุชุฑุฌุงุน</a>
      </div>
    </div>
  </footer>

  <!-- App JS -->
  <script src="./assets/app.js?v=2026-01-20"></script>

  <!-- Results renderer -->
  <script>
    (function () {
      "use strict";

      const STORAGE_KEY = "ayedTestResult";
      const el = (id) => document.getElementById(id);

      function escapeHtml(s) {
        return String(s)
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      function getResult() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return null;
          return JSON.parse(raw);
        } catch (e) {
          return null;
        }
      }

      function sectionGuidance(acc) {
        if (acc >= 85) return "ููุชุงุฒโุซุจุช ุจุงูููุงุฑุณุฉ ูุงูููุงุฐุฌ.";
        if (acc >= 70) return "ุฌูุฏโูุญุชุงุฌ ุชุซุจูุช + ููุงุฐุฌ.";
        if (acc >= 55) return "ูุจุบู ุดุบู ูุงุถุญโุงุจุฏุฃ ุจุดุฑุญ ุซู ุชุฏุฑูุจ.";
        return "ูุฐุง ุฃููููุงุชูโุฑูุฒ ุนููู ุฏุงุฎู ุงูุฏูุฑุฉ ุฃูู.";
      }

      function renderSections(sections) {
        const tbody = document.querySelector("#sectionsTable tbody");
        tbody.innerHTML = "";

        const keys = Object.keys(sections || {});
        if (!keys.length) return;

        keys.forEach((k) => {
          const s = sections[k];
          const tr = document.createElement("tr");
          const acc = Number(s.accuracy || 0);

          tr.innerHTML = `
            <td><span class="pill">${escapeHtml(s.label || k)}</span></td>
            <td>${escapeHtml(String(s.total || 0))}</td>
            <td>${escapeHtml(String(s.correct || 0))}</td>
            <td><b>${escapeHtml(String(acc))}%</b></td>
            <td class="muted">${escapeHtml(sectionGuidance(acc))}</td>
          `;
          tbody.appendChild(tr);
        });
      }

      function renderPlanBullets(bullets) {
        const ul = el("planBullets");
        ul.innerHTML = "";
        (bullets || []).forEach((b) => {
          const li = document.createElement("li");
          li.innerHTML = escapeHtml(b).replaceAll("\\n", "<br>");
          ul.appendChild(li);
        });
      }

      function renderWrong(wrong) {
        const wrap = el("wrongList");
        wrap.innerHTML = "";

        if (!wrong || !wrong.length) {
          wrap.innerHTML = `<div class="note note--soft"><p class="small">ููุชุงุฒ! ูุง ุนูุฏู ุฃุฎุทุงุก ูุณุฌูุฉ ูู ูุฐุง ุงูุงุฎุชุจุงุฑ ๐</p></div>`;
          return;
        }

        wrong.slice(0, 12).forEach((w, idx) => {
          const item = document.createElement("details");
          item.className = "acc-item";
          item.innerHTML = `
            <summary class="acc-sum">
              <span class="acc-num">#${idx + 1}</span>
              <span class="acc-title">${escapeHtml(w.sectionLabel || w.section || "")} โ ${escapeHtml((w.prompt || "").slice(0, 80))}${(w.prompt || "").length > 80 ? "โฆ" : ""}</span>
            </summary>

            <div class="acc-body">
              <div class="muted small" style="margin-bottom:8px;">ุงูุณุคุงู:</div>
              <div class="box">${escapeHtml(w.prompt || "")}</div>

              <div class="grid-2" style="margin-top:12px;">
                <div class="box box--warn">
                  <div class="muted small">ุฅุฌุงุจุชู</div>
                  <b>${escapeHtml(w.chosenText || "โ")}</b>
                </div>
                <div class="box box--ok">
                  <div class="muted small">ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ</div>
                  <b>${escapeHtml(w.correctText || "โ")}</b>
                </div>
              </div>

              ${w.explanation ? `
                <div style="margin-top:12px;">
                  <div class="muted small">ุญู ูุฎุชุตุฑ:</div>
                  <div class="box">${escapeHtml(w.explanation)}</div>
                </div>
              ` : ""}

              <div class="actions" style="margin-top:12px;">
                <a class="btn btn--primary" href="./course-content.html">ุฃุจุบู ุฃููู ูุฐุง ุงููุณู ุฏุงุฎู ุงูุฏูุฑุฉ</a>
                <a class="btn btn--ghost" href="./register.html">ุณุฌูููู ุนูู ุฎุทุชู</a>
              </div>
            </div>
          `;
          wrap.appendChild(item);
        });

        if (wrong.length > 12) {
          const more = document.createElement("div");
          more.className = "muted small";
          more.style.marginTop = "10px";
          more.textContent = `ููุงุญุธุฉ: ุชู ุนุฑุถ 12 ุฎุทุฃ ูู ุฃุตู ${wrong.length} (ุงูุจุงูู ููุฌูุฏ ุถูู ุจูุงูุงุชู).`;
          wrap.appendChild(more);
        }
      }

      function humanMinutes(min) {
        const m = Number(min || 0);
        if (!m) return "โ";
        if (m < 60) return m + " ุฏูููุฉ";
        const h = (m / 60);
        return (Math.round(h * 10) / 10) + " ุณุงุนุฉ";
      }

      // Seats placeholder (ูู app.js ูุง ุญุฏุซู)
      function seedSeatsFallback() {
        const seatsEl = el("seatsLeft");
        if (!seatsEl) return;
        if (seatsEl.textContent && seatsEl.textContent.trim() !== "โ") return;

        // ุฑูู ูุฑูุจ + ุชูุงุฒูู (Fallback ุจุณูุท)
        const base = 19;
        const drift = new Date().getDate() % 7; // 0..6
        const val = Math.max(3, base - drift);
        seatsEl.textContent = String(val);

        const hint = el("seatHint");
        if (hint) hint.textContent = val <= 6 ? "ุงูุทูุจ ุนุงููโฆ ุงูููุงุนุฏ ูุฑุจุช ุชุฎูุต." : "ุงูููุงุนุฏ ูุญุฏูุฏุฉ ูุถูุงู ุฌูุฏุฉ ุงููุชุงุจุนุฉ.";
      }

      // Main render
      const data = getResult();
      if (!data) {
        el("noResult").style.display = "block";
        return;
      }

      el("resultWrap").style.display = "block";
      el("resultVersion").textContent = "ูุณุฎุฉ: " + (data.version || "โ");

      // Profile
      el("rName").textContent = data.profile?.name || "โ";
      el("rExamDate").textContent = data.profile?.examDate || "โ";
      el("rDaily").textContent = humanMinutes(data.profile?.dailyMinutes);
      el("rTarget").textContent = (data.profile?.targetScore ? (data.profile.targetScore + "+") : "โ");

      // Score
      const pct = Number(data.score?.percent || 0);
      el("rPercent").textContent = pct + "%";
      el("rScoreLine").textContent = `ุตุญูุญ: ${data.score?.correct || 0} ูู ${data.score?.total || 0}`;
      el("rBar").style.width = Math.max(0, Math.min(100, pct)) + "%";

      // Summary line (ููุฌุฉ ูุทูุฆูุฉ)
      let msg = "ูุณุชูุงู ูุงุถุญ ุงูุขูโฆ ูุงูุฎุทุฉ ุจุชุณุงุนุฏู ุชูุดู ุตุญ.";
      if (pct >= 85) msg = "ููุชุงุฒ ุฌุฏูุง! ูุญุชุงุฌ ุชุซุจูุช ุจุงูููุงุฐุฌ ูุชุตููุฉ ุงูุฃุฎุทุงุก ููุท.";
      else if (pct >= 70) msg = "ุญูู ุฌุฏูุง! ููุฏุฑ ูุฑูุนู ุจุณุฑุนุฉ ุฅุฐุง ุฑูุฒูุง ุนูู ููุงุท ุถุนูู.";
      else if (pct >= 55) msg = "ุจุฏุงูุฉ ุทูุจุฉโุจุณ ูุญุชุงุฌ ุฎุทุฉ ูุงุถุญุฉ ุฏุงุฎู ุงูุฏูุฑุฉ ุนุดุงู ุชููุฒ ุฏุฑุฌุฉ.";
      else msg = "ูุง ุชุดูู ููโุงูุฎุทุท ููุง ูุตููุฉ ุชุฑูุนู ุฎุทูุฉ ุฎุทูุฉ ุจุฏูู ุชุดุชุช.";
      el("rSummaryLine").textContent = msg;

      // Sections
      renderSections(data.sections || {});

      // Plan
      el("planSummary").textContent = data.planSummary || "โ";
      el("planReasoning").textContent = data.planReasoning || "โ";
      renderPlanBullets(data.planBullets || []);

      // Wrong
      renderWrong(data.wrong || []);

      // Seats
      seedSeatsFallback();

      // ุฅุฐุง ูุฏู ุชุฑุจุท ุฒุฑ ุงูุชุณุฌูู ุจุฎุทุฉ ุงููุณุชุฎุฏู (ุงุฎุชูุงุฑู ูุงุญููุง)
      // ููุง ููุท ููุฏู ููุชุณุฌูู
      const regBtn = el("goRegisterBtn");
      if (regBtn) regBtn.href = "./register.html";
    })();
  </script>
</body>
</html>
